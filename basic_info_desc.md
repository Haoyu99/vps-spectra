## 目录 / Table of Contents / 目次

[![Hits](https://hits.spiritlhl.net/goecs.svg?action=hit&title=Hits&title_bg=%23555555&count_bg=%230eecf8&edge_flat=false)](https://hits.spiritlhl.net) [![Downloads](https://ghdownload.spiritlhl.net/oneclickvirt/ecs?color=36c600)](https://github.com/oneclickvirt/ecs/releases)

## 中文
- [系统基础信息](#系统基础信息)
- [CPU测试](#CPU测试)
- [内存测试](#内存测试)
- [硬盘测试](#硬盘测试)
- [流媒体解锁](#流媒体解锁)
- [IP质量检测](#IP质量检测)
- [邮件端口检测](#邮件端口检测)
- [上游及回程线路检测](#上游及回程线路检测)
- [三网回程路由检测](#三网回程路由检测)
- [就近测速](#就近测速)

---

## 中文

### **系统基础信息**

依赖项目：[https://github.com/oneclickvirt/basics](https://github.com/oneclickvirt/basics) [https://github.com/oneclickvirt/gostun](https://github.com/oneclickvirt/gostun)

CPU型号: 一般来说，按CPU的发布时间，都是新款则AMD好于Intel，都是旧款则Intel好于AMD，而Apple的M系列芯片则是断层式领先。

CPU数量: 会检测是物理核心还是逻辑核心，优先展示物理核心，查不到物理核心才去展示逻辑核心。在服务器实际使用过程中，程序一般是按逻辑核心分配执行的，非视频转码和科学计算，物理核心一般都是开超线程成逻辑核心用，横向比较的时候，对应类型的核心数量才有比较的意义。当然如果一个是物理核一个是虚拟核，在后面CPU测试得分类似的情况下，肯定是物理核更优，无需担忧CPU性能被共享的问题。

CPU缓存：显示的宿主机的CPU三级缓存信息。对普通应用可能影响不大，但对数据库、编译、大规模并发请求等场景，L3 大小显著影响性能。

AES-NI: AES指令集是加密解密加速用的，对于HTTPS(TLS/SSL)网络请求、VPN代理(配置使用的AES加密的)、磁盘加密这些场景有明显的优化，更快更省资源。

VM-x/AMD-V/Hyper-V: 是当前测试宿主机是否支持嵌套虚拟化的指标，如果测试环境是套在docker里测或者没有root权限，那么这个默认就是检测不到显示不支持嵌套虚拟化。这个指标在你需要在宿主机上开设虚拟机(如 KVM、VirtualBox、VMware)的时候有用，其他用途该指标用处不大。

内存: 显示内存 正在使用的大小/总大小 ，不含虚拟内存。

气球驱动: 显示宿主机是否启用了气球驱动。气球驱动用于宿主机和虚拟机之间动态调节内存分配：宿主机可以通过驱动要求虚拟机“放气”释放部分内存，或“充气”占用更多内存。启用它通常意味着宿主机具备内存超售能力，但是否真的存在超售，需要结合下面的内存读写测试查看是否有超售/严格的限制。

内核页合并：显示宿主机是否启用了内核页合并机制。KSM 会将多个进程中内容相同的内存页合并为一份，以减少物理内存占用。启用它通常意味着宿主机可能在进行内存节省或存在一定程度的内存超售。是否真正造成性能影响或内存紧张，需要结合下面的内存读写测试查看是否有超售/严格的限制。

虚拟内存: swap虚拟内存 是磁盘上划出的虚拟内存空间，用来在物理内存不足时临时存放数据。它能防止内存不足导致程序崩溃，但频繁使用会明显拖慢系统，Linux 官方推荐的 swap 配置如下：

| 物理内存大小             | 推荐 SWAP 大小 |
| ------------------ | ---------- |
| ≤ 2G               | 内存的 2 倍    |
| 2G < 内存 ≤ 8G       | 等于物理内存大小   |
| ≥ 8G               | 约 8G 即可    |
| 需要休眠 (hibernation) | 至少等于物理内存大小 |

硬盘空间: 显示硬盘 正在使用的大小/总大小

启动盘路径：显示启动盘的路径

系统: 显示系统名字和架构

内核: 显示系统内核版本

系统在线时间: 显示宿主机自从开机到测试时的已在线时长

时区: 显示宿主机系统时区

负载: 显示系统负载

虚拟化架构: 显示宿主机来自什么虚拟化架构，一般来说推荐```Dedicated > KVM > Xen```虚拟化，其他虚拟化都会存在性能损耗，导致使用的时候存在性能共享/损耗，但这个也说不准，独立服务器才拥有完全独立的资源占用，其他虚拟化基本都会有资源共享，取决于宿主机的持有者对这个虚拟机是否有良心，具体性能优劣还是得看后面的专项性能测试。

NAT类型: 显示NAT类型，具体推荐```Full Cone > Restricted Cone > Port Restricted Cone > Symmetric```，测不出来或者非正规协议的类型会显示```Inconclusive```，一般来说只有特殊用途，比如有特殊的代理、实时通讯、做FRP内穿端口等需求才需要特别关注，其他一般情况下都不用关注本指标。

TCP加速方式：一般是```cubic/bbr```拥塞控制协议，一般来说做代理服务器用bbr可以改善网速，普通用途不必关注此指标。

IPV4/IPV6 ASN: 显示宿主机IP所属的ASN组织ID和名字，同一个IDC可能会有多个ASN，ASN下可能有多个商家售卖不同段的IP的服务器，具体的上下游关系错综复杂，可使用 bgp.tool 进一步查看。

IPV4/IPV6 Location: 显示对应协议的IP在数据库中的地理位置。

IPV4 Active IPs: 根据 bgp.tools 信息查询当前CIDR分块中 活跃邻居数量/总邻居数量 由于是非实时的，可能存在延迟。

IPV6 子网掩码：根据宿主机信息查询的本机IPV6子网大小

### **CPU测试**

依赖项目：[https://github.com/oneclickvirt/cputest](https://github.com/oneclickvirt/cputest)

支持通过命令行参数选择```GeekBench```和```Sysbench```进行测试：

| 比较项             | sysbench | geekbench |
|------------------|----------|-----------|
| 适用范围         | 轻量级，几乎可在任何服务器上运行 | 重量级，小型机器无法运行 |
| 测试要求         | 无需网络，无特殊硬件需求 | 需联网，IPV4环境，至少1G内存 |
| 开源情况         | 基于LUA，开源，可自行编译各架构版本(本项目有重构为Go版本内置) | 官方二进制闭源代码，不支持自行编译 |
| 测试稳定性       | 核心测试组件10年以上未变 | 每个大版本更新测试项，分数不同版本间难以对比(每个版本对标当前最好的CPU) |
| 测试内容         | 仅测试计算性能，基于素数计算 | 覆盖多种性能测试，分数加权计算，但部分测试实际不常用 |
| 适用场景         | 适合快速测试，仅测试计算性能 | 适合综合全面的测试 |
| 排行榜         | [sysbench.spiritlhl.net](https://sysbench.spiritlhl.net/) | [browser.geekbench.com](https://browser.geekbench.com/) |

默认使用```Sysbench```进行测试，基准大致如下：

CPU测试单核```Sysbench```得分在5000以上的可以算第一梯队，4000到5000分算第二梯队，每1000分大致算一档。

AMD的7950x单核满血性能得分在6500左右，AMD的5950x单核满血性能得分5700左右，Intel普通的CPU(E5之类的)在1000~800左右，低于500的单核CPU可以说是性能比较差的了。

有时候多核得分和单核得分一样，证明商家在限制程序并发使用CPU，典型例子腾讯云。

```Sysbench```的基准可见 [CPU Performance Ladder For Sysbench](https://sysbench.spiritlhl.net/) 天梯图，具体得分不分测试的sysbench的版本。

```GeekBench```的基准可见 [官方网站](https://browser.geekbench.com/processor-benchmarks/) 天梯图，具体得分每个```GeekBench```版本都不一样，注意使用时测试的```GeekBench```版本是什么。

多说一句，```GeekBench```测的很多内容，实际在服务器使用过程中根本用不到，测试仅供参考。当然```Sysbench```非常不全面，但它基于最基础的计算性能可以大致比较CPU的性能。

实际上CPU性能测试够用就行，除非是科学计算以及视频转码，一般不需要特别追求高性能CPU。如果有性能需求，那么需要关注程序本身吃的是多核还是单核，对应看多核还是单核得分。

### **内存测试**

依赖项目：[https://github.com/oneclickvirt/memorytest](https://github.com/oneclickvirt/memorytest)

一般来说，只需要判断 IO 速度是否低于 `10240 MB/s (≈10 GB/s)`

如果低于这个值，那么证明内存性能不佳，极大概率存在超售超卖问题。

至于超开的原因可能是：

* 开了虚拟内存 (硬盘当内存用)
* 开了 ZRAM (牺牲 CPU 性能)
* 开了气球驱动 (Balloon Driver)
* 开了 KSM 内存融合

原因多种多样。

| 内存类型 | 典型频率 (MHz)   | 单通道带宽                                 | 双通道带宽                                   |
| ---- | ------------ | ------------------------------------- | --------------------------------------- |
| DDR3 | 1333 \~ 2133 | 10 \~ 17 GB/s (≈ 10240 \~ 17408 MB/s) | 20 \~ 34 GB/s (≈ 20480 \~ 34816 MB/s)   |
| DDR4 | 2133 \~ 3200 | 17 \~ 25 GB/s (≈ 17408 \~ 25600 MB/s) | 34 \~ 50 GB/s (≈ 34816 \~ 51200 MB/s)   |
| DDR5 | 4800 \~ 7200 | 38 \~ 57 GB/s (≈ 38912 \~ 58368 MB/s) | 76 \~ 114 GB/s (≈ 77824 \~ 116736 MB/s) |

根据上表内容，本项目测试的粗略判断方法：

* **< 20 GB/s (20480 MB/s)** → 可能是 DDR3（或 DDR4 单通道 / 低频）
* **20 \~ 40 GB/s (20480 \~ 40960 MB/s)** → 大概率 DDR4
* **≈ 50 GB/s (≈ 51200 MB/s)** → 基本就是 DDR5

对于各种测试参数对应方法的比较：

| 参数方法 | 测试准确性 | 速度 | 适应架构 | 依赖情况 |
|----------|------------|----------|----------|----------|
| stream  | 高, 结果稳定，更符合实际情况 | 快速 | 跨平台（Linux/Windows/Unix） | 自带依赖无需额外安装 |
| sysbench | 高, 结果较可靠 | 中等 | 跨平台（Linux、Windows 部分支持） | 需环境额外安装 |
| winsat | 中等偏高, Windows 内置工具 | 中等 | 仅限 Windows | 物理机器上自带，虚拟机不可用 |
| mbw | 中等, 结果可能受缓存/调度影响 | 快速 | 跨平台（几乎所有类 Unix 系统） | 自带依赖无需额外安装 |
| dd | 低, 结果受缓存影响 | 快速 | 跨平台（几乎所有类 Unix 系统） | 自带依赖无需额外安装 |

### **硬盘测试**

依赖项目：[https://github.com/oneclickvirt/disktest](https://github.com/oneclickvirt/disktest)

```dd```测试可能误差偏大但测试速度快无硬盘大小限制，```fio```测试真实一些但测试速度慢有硬盘以及内存大小的最低需求。

同时，服务器可能有不同的文件系统，某些文件系统的IO引擎在同样的硬件条件下测试的读写速度更快，这是正常的。项目默认使用```fio```进行测试，测试使用的IO引擎优先级为```libaio > posixaio > psync```，备选项```dd```测试在```fio```测试不可用时自动替换。

以```fio```测试结果为例基准如下：

| 操作系统类型 | 主要指标 | 次要指标 |
|---------|-------------------|---------------------|
| Windows/MacOS | 4K读 → 64K读 → 写入测试 | 图形界面系统优先考虑读取性能 |
| Linux (无图形界面) | 4K读 + 4K写 + 1M读写| 读/写值通常相似 |

以下硬盘类型对于指标值指 常规~满血 性能状态，指```libaio```作为IO测试引擎，指在```Linux```下进行测试

| 驱动类型 | 4K(IOPS)性能 | 1M(IOPS)性能 |
|------------|--------------------------|----------------------|
| NVMe SSD | ≥ 200 MB/s | 5-10 GB/s |
| 标准SSD | 50-100 MB/s | 2-3 GB/s |
| HDD (机械硬盘) | 10-40 MB/s | 500-600 MB/s |
| 性能不佳 | < 10 MB/s | < 200 MB/s |

快速评估：

1. **主要检查**: 4K读(IOPS) 4K写(IOPS)
    - 几乎相同差别不大
    - ≥ 200 MB/s = NVMe SSD
    - 50-100 MB/s = 标准SSD
    - 10-40 MB/s = HDD (机械硬盘)
    - < 10 MB/s = 垃圾性能，超售/限制严重

2. **次要检查**: 1M总和(IOPS)
    - 提供商设置的IO限制
    - 资源超开超售情况
    - 数值越高越好
    - NVMe SSD通常达到4-6 GB/s
    - 标准SSD通常达到1-2 GB/s

如果 NVMe SSD的1M(IOPS)值 < 1GB/s 表明存在严重的资源超开超售。

注意，这里测试的是真实的IO，仅限本项目，非本项目测试的IO不保证基准通用，因为他们测试的时候可能用的不是同样的参数，可能未设置IO直接读写，可能设置IO引擎不一致，可能设置测试时间不一致，都会导致基准有偏差。

### **流媒体解锁**

依赖项目：[https://github.com/oneclickvirt/CommonMediaTests](https://github.com/oneclickvirt/CommonMediaTests) [https://github.com/oneclickvirt/UnlockTests](https://github.com/oneclickvirt/UnlockTests)

默认只检测跨国流媒体解锁。

一般来说，正常的情况下，一个IP多个流媒体的解锁地区都是一致的不会到处乱飘，如果发现多家平台解锁地区不一致，那么IP大概率来自IPXO等平台租赁或者是刚刚宣告和被使用，未被流媒体普通的数据库所识别修正地域。由于各平台的IP数据库识别速度不一致，所以有时候有的平台解锁区域正常，有的飘到路由上的某个位置，有的飘到IP未被你使用前所在的位置。

| DNS 类型       | 解锁方式判断是否必要 | DNS 对解锁影响 | 说明                                      |
| ------------ | ---------- | --------- | --------------------------------------- |
| 官方主流 DNS     | 否          | 小         | 流媒体解锁主要依赖节点 IP，DNS 解析基本不会干扰解锁。          |
| 非主流 / 自建 DNS | 是          | 大         | 流媒体解锁结果受 DNS 解析影响较大，需要判断是原生解锁还是 DNS 解锁。 |

所以测试过程中，如果宿主机当前使用的是官方主流的DNS，不会进行是否为原生解锁的判断。

### **IP质量检测**

依赖项目：[https://github.com/oneclickvirt/securityCheck](https://github.com/oneclickvirt/securityCheck)

检测14个数据库的IP相关信息，一般来说看使用类型和公司类型还有安全信息的其他判别足矣，安全得分真的图一乐。多个平台比较对应检测项目都为对应值，证明当前IP确实如此，不要仅相信一个数据库源的信息。

* **使用类型 & 公司类型**：显示IP归属和使用场景，例如是否属于家庭用户、企业办公、托管服务或云/数据中心。
* **云提供商 / 数据中心 / 移动设备**：判断IP是否来自云服务、数据中心或移动网络，帮助识别共享或高风险IP。
* **代理 / VPN / Tor / Tor出口**：检测IP是否用于隐藏真实身份或位置，可能涉及匿名访问或滥用行为。
* **网络爬虫 / 机器人**：识别自动化访问或采集程序，对安全风险评估有参考价值。
* **匿名 / 滥用者 / 威胁 / 中继 / Bogon**：显示IP历史行为特征和是否属于保留/未分配IP，辅助判断IP可信度。
* **安全得分、声誉、信任得分、威胁得分、欺诈得分、滥用得分**：各数据库对IP的量化安全评价，仅供参考。
* **社区投票 & 黑名单记录**：展示用户反馈及公共黑名单信息，可快速识别潜在风险。
* **Google搜索可行性**：检测IP访问Google搜索服务的可行性，间接反映网络限制或屏蔽情况。

多平台对比更可靠，不同数据库算法和更新频率不同，单一来源可能存在误判。多个数据库显示相似结果，说明这个结果更可靠。

### **邮件端口检测**

依赖项目：[https://github.com/oneclickvirt/portchecker](https://github.com/oneclickvirt/portchecker)

- **SMTP（25）**：用于邮件服务器之间传输邮件（发送邮件）。
- **SMTPS（465）**：用于加密的 SMTP 发送邮件（SSL/TLS 方式）。
- **SMTP（587）**：用于客户端向邮件服务器发送邮件，支持 STARTTLS 加密。
- **POP3（110）**：用于邮件客户端从服务器下载邮件，不加密。
- **POP3S（995）**：用于加密的 POP3，安全地下载邮件（SSL/TLS 方式）。
- **IMAP（143）**：用于邮件客户端在线管理邮件（查看、同步邮件），不加密。
- **IMAPS（993）**：用于加密的 IMAP，安全地管理邮件（SSL/TLS 方式）。

具体当前宿主机不做邮局，不收发电子邮件，那么该项目指标不需要理会。

### **上游及回程线路检测**

依赖项目：[https://github.com/oneclickvirt/backtrace](https://github.com/oneclickvirt/backtrace)

#### 上游类型与运营商等级说明

- **直接上游（Direct Upstream）**  
  当前运营商直接购买网络服务的上级运营商，通常是 BGP 邻居。

- **间接上游（Indirect Upstream）**  
  直接上游的上级，形成层层向上的关系链。可通过 BGP 路由路径中的多跳信息识别。

| 等级 | 描述 |
|------|------|
| **Tier 1 Global** | 全球顶级运营商（如 AT&T、Verizon、NTT、Telia 等），之间免费互联（Settlement-Free Peering），不依赖他人即可访问全球任意网络。 |
| **Tier 1 Regional** | 区域性顶级运营商，在特定区域具有一级能力，但在全球范围互联性稍弱。 |
| **Tier 1 Indirect** | 间接连接的 Tier 1（非直接购买），通过中间上游间接接入 Tier 1 网络。 |
| **Tier 2** | 需要向 Tier 1 付费购买上网能力的二级运营商，通常是各国主流电信商或 ISP。 |
| **CDN Provider** | 内容分发网络提供商，如 Cloudflare、Akamai、Fastly 等，主要用于内容加速而非传统上游。 |
| **Direct/Indirect Others** | 其他类型的直接或间接连接，如 IX（Internet Exchange）成员、私有对等互联等。 |

上游质量判断：直接接入的高等级上游（特别是 Tier 1 Global）越多，通常网络连通性越好。但实际网络质量也受到以下因素影响：

  - 上下游之间的商业结算关系；
  - 购买的带宽套餐和服务质量；
  - 对等端口（Peering Ports）大小和负载；
  - 网络拥塞、路由策略、延迟路径等。

无法完全从 BGP 路由中判断。

一般来说，**接入高质量上游越多，网络连通性越优**。但由于存在诸多不可见的商业和技术因素，**无法仅凭上游等级准确判断网络质量**，上游检测约等于图一乐，实际得看对应的路由情况和长时间Ping的情况。

然后是检测当前的宿主机的IP地址 到 四个主要POP点城市的三个主要运营商的接入点的IP地址 的线路，具体来说

电信163、联通4837、移动CMI 是常见的线路，移动CMI对两广地区的移动运营商特供延迟低，也能算优质，仅限两广移动。

电信CN2GIA > 电信CN2GT 移动CMIN2 联通9929 算优质的线路

用什么运营商连宿主机的IP就看哪个运营商的线路就行了，具体线路的路由情况，看在下一个检测项看到对应的ICMP检测路由信息。

### **三网回程路由检测**

依赖项目：[https://github.com/oneclickvirt/nt3](https://github.com/oneclickvirt/nt3)

默认检测广州为目的地，实际可使用命令行参数指定目的地，见对应的参数说明。

主要就是看是不是直连，是不是延迟低，是不是没有隐藏路由信息，有没有一些优质线路或IX链接。

如果路由全球跑，延迟起飞，那么线路自然不会好到哪里去。

有时候路由信息完全藏起来了，只知道实际使用的延迟低，实际可能也是优质线路只是查不到信息，这就没办法直接识别了。

### **就近测速**

依赖项目：[https://github.com/oneclickvirt/speedtest](https://github.com/oneclickvirt/speedtest)

先测的官方推荐的测速点，然后测有代表性的国际测速点，最后测国内三大运营商ping值最低的测速点。

境内使用为主就看境内测速即可，境外使用看境外测速，官方测速点可以代表受测的宿主机本地带宽基准。

一般来说中国境外的服务器的带宽100Mbps起步，中国境内的服务器1Mbps带宽起步，具体看线路优劣，带宽特别大有时候未必用得上，够用就行了。

日常我偏向使用1Gbps带宽的服务器，至少下载依赖什么的速度足够快，境内小水管几Mbps真的下半天下不完，恨不得到机房插个U盘转移数据。

---


